<h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#database-creation">Database Creation</a></li>
<li><a href="#using-sql-queries-in-jupyter-notebook">Using SQL Queries in jupyter Notebook</a></li>
<li><a href="#sql-queries">SQL Queries</a></li>
<li><a href="#script-to-create-tables">Script to create tables</a></li>
<li><a href="#sql-queries-1">SQL Queries</a>
<ul>
<li><a href="#obtain-the-names-of-all-physicians-that-have-performed-a-medical-procedure-they-have-never-been-certified-to-perform">Obtain the names of all physicians that have performed a medical procedure they have never been certified to perform</a></li>
<li><a href="#same-as-the-previous-query-but-include-the-following-information-in-the-results-physician-name-name-of-procedure-date-when-the-procedure-was-carried-out-name-of-the-patient-the-procedure-was-carried-out-on">Same as the previous query, but include the following information in the results: Physician name, name of procedure, date when the procedure was carried out, name of the patient the procedure was carried out on.</a></li>
<li><a href="#obtain-the-names-of-all-physicians-that-have-performed-a-medical-procedure-that-they-are-certified-to-perform-but-such-that-the-procedure-was-done-at-a-date-undergoesdate-after-the-physicians-certification-expired-trained_incertificationexpires">Obtain the names of all physicians that have performed a medical procedure that they are certified to perform, but such that the procedure was done at a date (Undergoes.Date) after the physician’s certification expired (Trained_In.CertificationExpires)</a></li>
<li><a href="#same-as-the-previous-query-but-include-the-following-information-in-the-results-physician-name-name-of-procedure-date-when-the-procedure-was-carried-out-name-of-the-patient-the-procedure-was-carried-out-on-and-date-when-the-certification-expired">Same as the previous query, but include the following information in the results: Physician name, name of procedure, date when the procedure was carried out, name of the patient the procedure was carried out on, and date when the certification expired.</a></li>
<li><a href="#obtain-the-information-for-appointments-where-a-patient-met-with-a-physician-other-than-hisher-primary-care-physician-show-the-following-information-patient-name-physician-name-nurse-name-if-any-start-and-end-time-of-appointment-examination-room-and-the-name-of-the-patients-primary-care-physician">Obtain the information for appointments where a patient met with a physician other than his/her primary care physician. Show the following information: Patient name, physician name, nurse name (if any), start and end time of appointment, examination room, and the name of the patient’s primary care physician.</a></li>
<li><a href="#the-patient-field-in-undergoes-is-redundant-since-we-can-obtain-it-from-the-stay-table-there-are-no-constraints-in-force-to-prevent-inconsistencies-between-these-two-tables-more-specifically-the-undergoes-table-may-include-a-row-where-the-patient-id-does-not-match-the-one-we-would-obtain-from-the-stay-table-through-the-undergoesstay-foreign-key-select-all-rows-from-undergoes-that-exhibit-this-inconsistency">The Patient field in Undergoes is redundant, since we can obtain it from the Stay table. There are no constraints in force to prevent inconsistencies between these two tables. More specifically, the Undergoes table may include a row where the patient ID does not match the one we would obtain from the Stay table through the Undergoes.Stay foreign key. Select all rows from Undergoes that exhibit this inconsistency.</a></li>
<li><a href="#obtain-the-names-of-all-the-nurses-who-have-ever-been-on-call-for-room-123">Obtain the names of all the nurses who have ever been on call for room 123.</a></li>
<li><a href="#the-hospital-has-several-examination-rooms-where-appointments-take-place-obtain-the-number-of-appointments-that-have-taken-place-in-each-examination-room">The hospital has several examination rooms where appointments take place. Obtain the number of appointments that have taken place in each examination room.</a></li>
<li><a href="#obtain-the-names-of-all-patients-also-include-for-each-patient-the-name-of-the-patients-primary-care-physician-such-that-all-the-following-are-true">Obtain the names of all patients (also include, for each patient, the name of the patient’s primary care physician), such that all the following are true</a></li>
</ul></li>
</ul>
<h1 id="database-creation">Database Creation</h1>
<p>In this project, I have recreated the hospital management database in postgresql flavor of SQL from mySQL flavor of <a href="https://en.wikibooks.org/wiki/SQL_Exercises/The_Hospital">wikibooks</a>. The database has following 15 tables:</p>
<ol type="1">
<li>Physician</li>
<li>Department</li>
<li>Affiliated_With</li>
<li>Procedure</li>
<li>Trained_In</li>
<li>Patient</li>
<li>Nurse</li>
<li>Appointment</li>
<li>Medication</li>
<li>Prescribes</li>
<li>Block</li>
<li>Room</li>
<li>On_Call</li>
<li>Stay</li>
<li>Undergoes</li>
</ol>
<p>The entity relation is given below: <img src="images/ER_the_hospital.png" /></p>
<h1 id="using-sql-queries-in-jupyter-notebook">Using SQL Queries in jupyter Notebook</h1>
<ul>
<li>First we need to install postgresql and its official app <a href="https://www.pgadmin.org">pgAdmin</a>.</li>
<li>Then we need to install sql magics in one of the conda environment. I have a conda environment <code>spk</code> for that purpose and I have installed <code>sqlachemy</code> module there.</li>
</ul>
<h1 id="sql-queries">SQL Queries</h1>
<ol type="1">
<li><p>Obtain the names of all physicians that have performed a medical procedure they have never been certified to perform.</p></li>
<li><p>Same as the previous query, but include the following information in the results: Physician name, name of procedure, date when the procedure was carried out, name of the patient the procedure was carried out on.</p></li>
<li><p>Obtain the names of all physicians that have performed a medical procedure that they are certified to perform, but such that the procedure was done at a date (Undergoes.Date) after the physician’s certification expired (Trained_In.CertificationExpires).</p></li>
<li><p>Same as the previous query, but include the following information in the results: Physician name, name of procedure, date when the procedure was carried out, name of the patient the procedure was carried out on, and date when the certification expired.</p></li>
<li><p>Obtain the information for appointments where a patient met with a physician other than his/her primary care physician. Show the following information: Patient name, physician name, nurse name (if any), start and end time of appointment, examination room, and the name of the patient’s primary care physician.</p></li>
<li><p>The Patient field in Undergoes is redundant, since we can obtain it from the Stay table. There are no constraints in force to prevent inconsistencies between these two tables. More specifically, the Undergoes table may include a row where the patient ID does not match the one we would obtain from the Stay table through the Undergoes.Stay foreign key. Select all rows from Undergoes that exhibit this inconsistency.</p></li>
<li><p>The hospital has several examination rooms where appointments take place. Obtain the number of appointments that have taken place in each examination room.</p></li>
<li><p>Obtain the names of all patients (also include, for each patient, the name of the patient’s primary care physician), such that all the following are true.</p></li>
</ol>
<h1 id="script-to-create-tables">Script to create tables</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Physician (</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  EmployeeID <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  Name TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Position TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  SSN <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Department (</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  DepartmentID <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  Name TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  Head <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Physician_EmployeeID <span class="kw">REFERENCES</span> Physician(EmployeeID)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Affiliated_With (</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  Physician <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Physician_EmployeeID <span class="kw">REFERENCES</span> Physician(EmployeeID),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  Department <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Department_DepartmentID <span class="kw">REFERENCES</span> Department(DepartmentID),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  PrimaryAffiliation <span class="dt">BOOLEAN</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(Physician, Department)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="kw">Procedure</span> (</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  Code <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  Name TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Cost</span> <span class="dt">REAL</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Trained_In (</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  Physician <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Physician_EmployeeID <span class="kw">REFERENCES</span> Physician(EmployeeID),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  Treatment <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Procedure_Code <span class="kw">REFERENCES</span> <span class="kw">Procedure</span>(Code),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  CertificationDate DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  CertificationExpires DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(Physician, Treatment)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Patient (</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  SSN <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  Name TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  Address TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  Phone TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  InsuranceID <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  PCP <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Physician_EmployeeID <span class="kw">REFERENCES</span> Physician(EmployeeID)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Nurse (</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  EmployeeID <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  Name TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  Position TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  Registered <span class="dt">BOOLEAN</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  SSN <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Appointment (</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  AppointmentID <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  Patient <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Patient_SSN <span class="kw">REFERENCES</span> Patient(SSN),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  PrepNurse <span class="dt">INTEGER</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Nurse_EmployeeID <span class="kw">REFERENCES</span> Nurse(EmployeeID),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  Physician <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Physician_EmployeeID <span class="kw">REFERENCES</span> Physician(EmployeeID),</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Start</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">End</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  ExaminationRoom TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Medication (</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  Code <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  Name TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  Brand TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  Description TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Prescribes (</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  Physician <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Physician_EmployeeID <span class="kw">REFERENCES</span> Physician(EmployeeID),</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  Patient <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Patient_SSN <span class="kw">REFERENCES</span> Patient(SSN),</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  Medication <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Medication_Code <span class="kw">REFERENCES</span> Medication(Code),</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Date</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  Appointment <span class="dt">INTEGER</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Appointment_AppointmentID <span class="kw">REFERENCES</span> Appointment(AppointmentID),</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  Dose TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(Physician, Patient, Medication, <span class="dt">Date</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="kw">Block</span> (</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Floor</span> <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  Code <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(<span class="fu">Floor</span>, Code)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Room (</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Number</span> <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Type</span> TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  BlockFloor <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Block_Floor <span class="kw">REFERENCES</span> <span class="kw">Block</span>(<span class="fu">Floor</span>),</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  BlockCode <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Block_Code <span class="kw">REFERENCES</span> <span class="kw">Block</span>(Code),</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  Unavailable <span class="dt">BOOLEAN</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> On_Call (</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  Nurse <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Nurse_EmployeeID <span class="kw">REFERENCES</span> Nurse(EmployeeID),</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  BlockFloor <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Block_Floor <span class="kw">REFERENCES</span> <span class="kw">Block</span>(<span class="fu">Floor</span>),</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  BlockCode <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Block_Code <span class="kw">REFERENCES</span> <span class="kw">Block</span>(Code),</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Start</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  <span class="cf">End</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(Nurse, BlockFloor, BlockCode, <span class="kw">Start</span>, <span class="cf">End</span>)</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Stay (</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  StayID <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>  Patient <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Patient_SSN <span class="kw">REFERENCES</span> Patient(SSN),</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  Room <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Room_Number <span class="kw">REFERENCES</span> Room(<span class="dt">Number</span>),</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Start</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  <span class="cf">End</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> Undergoes (</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  Patient <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Patient_SSN <span class="kw">REFERENCES</span> Patient(SSN),</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Procedure</span> <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Procedure_Code <span class="kw">REFERENCES</span> <span class="kw">Procedure</span>(Code),</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  Stay <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Stay_StayID <span class="kw">REFERENCES</span> Stay(StayID),</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Date</span> DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  Physician <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Physician_EmployeeID <span class="kw">REFERENCES</span> Physician(EmployeeID),</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  AssistingNurse <span class="dt">INTEGER</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> fk_Nurse_EmployeeID <span class="kw">REFERENCES</span> Nurse(EmployeeID),</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(Patient, <span class="kw">Procedure</span>, Stay, <span class="dt">Date</span>)</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<h1 id="sql-queries-1">SQL Queries</h1>
<h2 id="obtain-the-names-of-all-physicians-that-have-performed-a-medical-procedure-they-have-never-been-certified-to-perform">Obtain the names of all physicians that have performed a medical procedure they have never been certified to perform</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> Name</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> Physician</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> EmployeeID <span class="kw">IN</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>       (</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="kw">SELECT</span> Physician <span class="kw">FROM</span> Undergoes U <span class="kw">WHERE</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               <span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> Trained_In</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> Treatment <span class="op">=</span> <span class="kw">Procedure</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">AND</span> Physician <span class="op">=</span> U.Physician</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>       );</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> P.Name <span class="kw">FROM</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a> Physician <span class="kw">AS</span> P,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a> (<span class="kw">SELECT</span> Physician, <span class="kw">Procedure</span> <span class="kw">FROM</span> Undergoes</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">EXCEPT</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> Physician, Treatment <span class="kw">FROM</span> Trained_in) <span class="kw">AS</span> Pe</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> P.EmployeeID<span class="op">=</span>Pe.Physician</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> Name</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> Physician</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> EmployeeID <span class="kw">IN</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>   (</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      <span class="kw">SELECT</span> Undergoes.Physician</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> Undergoes</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>             <span class="kw">LEFT</span> <span class="kw">JOIN</span> Trained_In</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>             <span class="kw">ON</span> Undergoes.Physician<span class="op">=</span>Trained_In.Physician</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">AND</span> Undergoes.<span class="kw">Procedure</span><span class="op">=</span>Trained_In.Treatment</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>       <span class="kw">WHERE</span> Treatment <span class="kw">IS</span> <span class="kw">NULL</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>   )</span></code></pre></div>
<h2 id="same-as-the-previous-query-but-include-the-following-information-in-the-results-physician-name-name-of-procedure-date-when-the-procedure-was-carried-out-name-of-the-patient-the-procedure-was-carried-out-on.">Same as the previous query, but include the following information in the results: Physician name, name of procedure, date when the procedure was carried out, name of the patient the procedure was carried out on.</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> P.Name <span class="kw">AS</span> Physician, Pr.Name <span class="kw">AS</span> <span class="kw">Procedure</span>, U.<span class="dt">Date</span>, Pt.Name <span class="kw">AS</span> Patient</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> Physician P, Undergoes U, Patient Pt, <span class="kw">Procedure</span> Pr</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> U.Patient <span class="op">=</span> Pt.SSN</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> U.<span class="kw">Procedure</span> <span class="op">=</span> Pr.Code</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> U.Physician <span class="op">=</span> P.EmployeeID</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>              (</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> Trained_In T</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> T.Treatment <span class="op">=</span> U.<span class="kw">Procedure</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> T.Physician <span class="op">=</span> U.Physician</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>              );</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> P.Name,Pr.Name,U.<span class="dt">Date</span>,Pt.Name <span class="kw">FROM</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a> Physician <span class="kw">AS</span> P,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a> <span class="kw">Procedure</span> <span class="kw">AS</span> Pr,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a> Undergoes <span class="kw">AS</span> U,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a> Patient <span class="kw">AS</span> Pt,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a> (<span class="kw">SELECT</span> Physician, <span class="kw">Procedure</span> <span class="kw">FROM</span> Undergoes</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">EXCEPT</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> Physician, Treatment <span class="kw">FROM</span> Trained_in) <span class="kw">AS</span> Pe</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> P.EmployeeID<span class="op">=</span>Pe.Physician <span class="kw">AND</span> Pe.<span class="kw">Procedure</span><span class="op">=</span>Pr.Code <span class="kw">AND</span> Pe.Physician<span class="op">=</span>U.Physician <span class="kw">AND</span> Pe.<span class="kw">Procedure</span><span class="op">=</span>U.<span class="kw">Procedure</span> <span class="kw">AND</span> U.Patient<span class="op">=</span>Pt.SSN</span></code></pre></div>
<h2 id="obtain-the-names-of-all-physicians-that-have-performed-a-medical-procedure-that-they-are-certified-to-perform-but-such-that-the-procedure-was-done-at-a-date-undergoes.date-after-the-physicians-certification-expired-trained_in.certificationexpires">Obtain the names of all physicians that have performed a medical procedure that they are certified to perform, but such that the procedure was done at a date (Undergoes.Date) after the physician’s certification expired (Trained_In.CertificationExpires)</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> Name</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> Physician</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> EmployeeID <span class="kw">IN</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>       (</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="kw">SELECT</span> Physician <span class="kw">FROM</span> Undergoes U</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>          <span class="kw">WHERE</span> <span class="dt">Date</span> <span class="op">&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>               (</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">SELECT</span> CertificationExpires</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">FROM</span> Trained_In T</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">WHERE</span> T.Physician <span class="op">=</span> U.Physician</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                     <span class="kw">AND</span> T.Treatment <span class="op">=</span> U.<span class="kw">Procedure</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>       );</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> P.Name <span class="kw">FROM</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a> Physician <span class="kw">AS</span> P,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a> Trained_In T,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a> Undergoes <span class="kw">AS</span> U</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> T.Physician<span class="op">=</span>U.Physician <span class="kw">AND</span> T.Treatment<span class="op">=</span>U.<span class="kw">Procedure</span> <span class="kw">AND</span> U.<span class="dt">Date</span><span class="op">&gt;</span>T.CertificationExpires <span class="kw">AND</span> P.EmployeeID<span class="op">=</span>U.Physician</span></code></pre></div>
<h2 id="same-as-the-previous-query-but-include-the-following-information-in-the-results-physician-name-name-of-procedure-date-when-the-procedure-was-carried-out-name-of-the-patient-the-procedure-was-carried-out-on-and-date-when-the-certification-expired.">Same as the previous query, but include the following information in the results: Physician name, name of procedure, date when the procedure was carried out, name of the patient the procedure was carried out on, and date when the certification expired.</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> P.Name <span class="kw">AS</span> Physician, Pr.Name <span class="kw">AS</span> <span class="kw">Procedure</span>, U.<span class="dt">Date</span>, Pt.Name <span class="kw">AS</span> Patient, T.CertificationExpires</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> Physician P, Undergoes U, Patient Pt, <span class="kw">Procedure</span> Pr, Trained_In T</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> U.Patient <span class="op">=</span> Pt.SSN</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> U.<span class="kw">Procedure</span> <span class="op">=</span> Pr.Code</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> U.Physician <span class="op">=</span> P.EmployeeID</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> Pr.Code <span class="op">=</span> T.Treatment</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> P.EmployeeID <span class="op">=</span> T.Physician</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> U.<span class="dt">Date</span> <span class="op">&gt;</span> T.CertificationExpires</span></code></pre></div>
<h2 id="obtain-the-information-for-appointments-where-a-patient-met-with-a-physician-other-than-hisher-primary-care-physician.-show-the-following-information-patient-name-physician-name-nurse-name-if-any-start-and-end-time-of-appointment-examination-room-and-the-name-of-the-patients-primary-care-physician.">Obtain the information for appointments where a patient met with a physician other than his/her primary care physician. Show the following information: Patient name, physician name, nurse name (if any), start and end time of appointment, examination room, and the name of the patient’s primary care physician.</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> Pt.Name <span class="kw">AS</span> Patient, Ph.Name <span class="kw">AS</span> Physician, N.Name <span class="kw">AS</span> Nurse, A.<span class="kw">Start</span>, A.<span class="cf">End</span>, A.ExaminationRoom, PhPCP.Name <span class="kw">AS</span> PCP</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> Patient Pt, Physician Ph, Physician PhPCP, Appointment A <span class="kw">LEFT</span> <span class="kw">JOIN</span> Nurse N <span class="kw">ON</span> A.PrepNurse <span class="op">=</span> N.EmployeeID</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> A.Patient <span class="op">=</span> Pt.SSN</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> A.Physician <span class="op">=</span> Ph.EmployeeID</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> Pt.PCP <span class="op">=</span> PhPCP.EmployeeID</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> A.Physician <span class="op">&lt;&gt;</span> Pt.PCP;</span></code></pre></div>
<h2 id="the-patient-field-in-undergoes-is-redundant-since-we-can-obtain-it-from-the-stay-table.-there-are-no-constraints-in-force-to-prevent-inconsistencies-between-these-two-tables.-more-specifically-the-undergoes-table-may-include-a-row-where-the-patient-id-does-not-match-the-one-we-would-obtain-from-the-stay-table-through-the-undergoes.stay-foreign-key.-select-all-rows-from-undergoes-that-exhibit-this-inconsistency.">The Patient field in Undergoes is redundant, since we can obtain it from the Stay table. There are no constraints in force to prevent inconsistencies between these two tables. More specifically, the Undergoes table may include a row where the patient ID does not match the one we would obtain from the Stay table through the Undergoes.Stay foreign key. Select all rows from Undergoes that exhibit this inconsistency.</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> Undergoes U</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> Patient <span class="op">&lt;&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>   (</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="kw">SELECT</span> Patient <span class="kw">FROM</span> Stay S</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">WHERE</span> U.Stay <span class="op">=</span> S.StayID</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>   );</span></code></pre></div>
<h2 id="obtain-the-names-of-all-the-nurses-who-have-ever-been-on-call-for-room-123.">Obtain the names of all the nurses who have ever been on call for room 123.</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> N.Name <span class="kw">FROM</span> Nurse N</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> EmployeeID <span class="kw">IN</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>   (</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     <span class="kw">SELECT</span> OC.Nurse <span class="kw">FROM</span> On_Call OC, Room R</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">WHERE</span> OC.BlockFloor <span class="op">=</span> R.BlockFloor</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> OC.BlockCode <span class="op">=</span> R.BlockCode</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> R.<span class="dt">Number</span> <span class="op">=</span> <span class="dv">123</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>   );</span></code></pre></div>
<h2 id="the-hospital-has-several-examination-rooms-where-appointments-take-place.-obtain-the-number-of-appointments-that-have-taken-place-in-each-examination-room.">The hospital has several examination rooms where appointments take place. Obtain the number of appointments that have taken place in each examination room.</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> ExaminationRoom, <span class="fu">COUNT</span>(AppointmentID) <span class="kw">AS</span> <span class="dt">Number</span> <span class="kw">FROM</span> Appointment</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> ExaminationRoom;</span></code></pre></div>
<h2 id="obtain-the-names-of-all-patients-also-include-for-each-patient-the-name-of-the-patients-primary-care-physician-such-that-all-the-following-are-true">Obtain the names of all patients (also include, for each patient, the name of the patient’s primary care physician), such that all the following are true</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> Pt.Name, PhPCP.Name <span class="kw">FROM</span> Patient Pt, Physician PhPCP</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> Pt.PCP <span class="op">=</span> PhPCP.EmployeeID</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> <span class="kw">EXISTS</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>       (</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         <span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> Prescribes Pr</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>          <span class="kw">WHERE</span> Pr.Patient <span class="op">=</span> Pt.SSN</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">AND</span> Pr.Physician <span class="op">=</span> Pt.PCP</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> <span class="kw">EXISTS</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>       (</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>         <span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> Undergoes U, <span class="kw">Procedure</span> Pr</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>          <span class="kw">WHERE</span> U.<span class="kw">Procedure</span> <span class="op">=</span> Pr.Code</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>            <span class="kw">AND</span> U.Patient <span class="op">=</span> Pt.SSN</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">AND</span> Pr.<span class="kw">Cost</span> <span class="op">&gt;</span> <span class="dv">5000</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> <span class="dv">2</span> <span class="op">&lt;=</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>       (</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>         <span class="kw">SELECT</span> <span class="fu">COUNT</span>(A.AppointmentID) <span class="kw">FROM</span> Appointment A, Nurse N</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>          <span class="kw">WHERE</span> A.PrepNurse <span class="op">=</span> N.EmployeeID</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>            <span class="kw">AND</span> N.Registered <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>   <span class="kw">AND</span> <span class="kw">NOT</span> Pt.PCP <span class="kw">IN</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>       (</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>          <span class="kw">SELECT</span> Head <span class="kw">FROM</span> Department</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>       );</span></code></pre></div>
