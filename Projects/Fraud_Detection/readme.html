<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="project-description">Project Description</h1>
<p>In this project I used the <a href="https://www.kaggle.com/mlg-ulb/creditcardfraud">Kaggle Creditcard Fraud</a> data to determine whether the transaction is fraud or not.</p>
<p><strong>Assumptions</strong>: - Here we have data for just two days, but we assume the data is representative of the whole population of credit card transactions. - We assume the 28 variables V1-V28 are obtained from correct method of PCA and are scaled properly.</p>
<p><strong>Metric Used</strong> - Here 1 means fraud and 0 means no fraud. - The metric used is <code>Recall = TP / (TP + FN)</code> since we are interested in fraud case, not the overall accuracy of the model. - Note that for imbalanced data, the use of ROC curve (ie. ROC AUC or x=FPR Y=TPR) is not useful, instead we use Precision-Recall Curve Which will show the harmonic mean of F-Score (1/F1 = 2/(Precision^-1 + Recall^-1) and that is more useful.</p>
<p><strong>Resampling Techniques</strong> - Under-sampling. (We have low number of frauds, choose randomly same number of non-frauds.) - Oversampling <code>SMOTE</code> method. Used external library <code>imblearn</code>.</p>
<h1 style="background-color:tomato;">
Best Model So Far
</h1>
<table style="width:62%;">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Description</th>
<th align="left">Accuracy</th>
<th align="left">Precision</th>
<th align="left">Recall</th>
<th align="left">F1</th>
<th align="left">AUC</th>
<th align="left">Untrue Frauds</th>
<th align="left">Missed Frauds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">keras</td>
<td align="left">1 layer, class_weight, early_stopping, scikit api</td>
<td align="left">0.987939</td>
<td align="left">0.111989</td>
<td align="left">0.867347</td>
<td align="left">0.198366</td>
<td align="left">0.927747</td>
<td align="left">674</td>
<td align="left">13</td>
</tr>
<tr class="even">
<td align="left">cb_tuned pycaret</td>
<td align="left">fold=5</td>
<td align="left">0.9996</td>
<td align="left">0.9659</td>
<td align="left">0.7865</td>
<td align="left">0.9667</td>
<td align="left">0.8642</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">catboost</td>
<td align="left">seed=100,depth=6,iter=1k</td>
<td align="left">0.999631</td>
<td align="left">1.000000</td>
<td align="left">0.785714</td>
<td align="left">0.880000</td>
<td align="left">0.892857</td>
<td align="left">0</td>
<td align="left">21</td>
</tr>
</tbody>
</table>
<p></br></p>
<h1 style="background-color:tomato;">
Undersampling
</h1>
<p><strong>Recall for all Classifiers with Grid Search for Undersampled Data</strong> <img src="reports/screenshots/recall_all_models_undersample_grid.png" /> <img src="reports/screenshots/cm_lr_undersample_grid.png" /></p>
<p></br></p>
<h1 style="background-color:tomato;">
SMOTE Oversampling: Logistic Regression
</h1>
<p><img src="reports/screenshots/lr_model_evaluation_scalar_metrics.png" /> <img src="reports/screenshots/cm_lr_smote_grid.png" /></p>
<p></br></p>
<h1 style="background-color:tomato;">
Anomaly Detection Methods
</h1>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Description</th>
<th align="left">Accuracy</th>
<th align="left">Precision</th>
<th align="left">Recall</th>
<th align="left">F1(Weighted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Isolation Forest</td>
<td align="left">default</td>
<td align="left">0.997384</td>
<td align="left">0.261682</td>
<td align="left">0.285714</td>
<td align="left">0.997442</td>
</tr>
<tr class="even">
<td align="left">Local Outlier Factor</td>
<td align="left">default</td>
<td align="left">0.996331</td>
<td align="left">0.025641</td>
<td align="left">0.030612</td>
<td align="left">0.996493</td>
</tr>
</tbody>
</table>
<p></br></p>
<h1 style="background-color:tomato;">
Gradient Boosting Modelling
</h1>
<table style="width:49%;">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Description</th>
<th align="left">Accuracy</th>
<th align="left">Precision</th>
<th align="left">Recall</th>
<th align="left">F1</th>
<th align="left">AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lightgbm</td>
<td align="left">grid search optuna</td>
<td align="left">0.999315</td>
<td align="left">0.873418</td>
<td align="left">0.704082</td>
<td align="left">0.779661</td>
<td align="left">0.851953</td>
</tr>
<tr class="even">
<td align="left">lightgbm</td>
<td align="left">default</td>
<td align="left">0.997367</td>
<td align="left">0.275862</td>
<td align="left">0.326531</td>
<td align="left">0.299065</td>
<td align="left">0.662527</td>
</tr>
<tr class="odd">
<td align="left">Xgboost</td>
<td align="left">default, imbalanced</td>
<td align="left">0.999263</td>
<td align="left">0.850000</td>
<td align="left">0.693878</td>
<td align="left">0.764045</td>
<td align="left">0.846833</td>
</tr>
<tr class="even">
<td align="left">Xgboost</td>
<td align="left">default, undersampling</td>
<td align="left">0.999263</td>
<td align="left">0.850000</td>
<td align="left">0.693878</td>
<td align="left">0.764045</td>
<td align="left">0.846833</td>
</tr>
<tr class="odd">
<td align="left">Xgboost</td>
<td align="left">n_estimators=150, imbalanced</td>
<td align="left">0.999263</td>
<td align="left">0.850000</td>
<td align="left">0.693878</td>
<td align="left">0.764045</td>
<td align="left">0.846833</td>
</tr>
<tr class="even">
<td align="left">Xgboost</td>
<td align="left">undersample, hpo1</td>
<td align="left">0.999298</td>
<td align="left">0.881579</td>
<td align="left">0.683673</td>
<td align="left">0.770115</td>
<td align="left">0.841758</td>
</tr>
<tr class="odd">
<td align="left">Xgboost</td>
<td align="left">imbalanced, hpo</td>
<td align="left">0.999245</td>
<td align="left">0.898551</td>
<td align="left">0.632653</td>
<td align="left">0.742515</td>
<td align="left">0.816265</td>
</tr>
<tr class="even">
<td align="left">xgboost</td>
<td align="left">grid search optuna</td>
<td align="left">0.999333</td>
<td align="left">0.875000</td>
<td align="left">0.714286</td>
<td align="left">0.786517</td>
<td align="left">0.857055</td>
</tr>
<tr class="odd">
<td align="left">catboost</td>
<td align="left">seed=100,depth=6,iter=1k</td>
<td align="left">0.999631</td>
<td align="left">1.000000</td>
<td align="left">0.785714</td>
<td align="left">0.880000</td>
<td align="left">0.892857</td>
</tr>
</tbody>
</table>
<p></br></p>
<h1 style="background-color:tomato;">
Automatic Modelling: pycaret
</h1>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Description</th>
<th align="left">Accuracy</th>
<th align="left">AUC</th>
<th align="left">Recall</th>
<th align="left">Precision</th>
<th align="left">F1</th>
<th align="left">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">cb_tuned</td>
<td align="left">fold=5</td>
<td align="left">0.9996</td>
<td align="left">0.9659</td>
<td align="left">0.7865</td>
<td align="left">0.9667</td>
<td align="left">0.8642</td>
<td align="left">0.8639</td>
</tr>
<tr class="even">
<td align="left">lda_tuned</td>
<td align="left">fold=5</td>
<td align="left">0.9995</td>
<td align="left">0.9833</td>
<td align="left">0.7760</td>
<td align="left">0.9217</td>
<td align="left">0.8423</td>
<td align="left">0.8420</td>
</tr>
<tr class="odd">
<td align="left">xgb</td>
<td align="left">default</td>
<td align="left">0.9994</td>
<td align="left">0.9585</td>
<td align="left">0.7345</td>
<td align="left">0.9102</td>
<td align="left">0.8047</td>
<td align="left">0.8044</td>
</tr>
<tr class="even">
<td align="left">cb</td>
<td align="left">default</td>
<td align="left">0.9995</td>
<td align="left">0.9554</td>
<td align="left">0.7345</td>
<td align="left">0.9548</td>
<td align="left">0.8215</td>
<td align="left">0.8212</td>
</tr>
<tr class="odd">
<td align="left">lda</td>
<td align="left">default</td>
<td align="left">0.9992</td>
<td align="left">0.9677</td>
<td align="left">0.7255</td>
<td align="left">0.8340</td>
<td align="left">0.7661</td>
<td align="left">0.7657</td>
</tr>
<tr class="even">
<td align="left">xgb_tuned</td>
<td align="left">tuned</td>
<td align="left">0.9992</td>
<td align="left">0.9677</td>
<td align="left">0.7255</td>
<td align="left">0.8340</td>
<td align="left">0.7661</td>
<td align="left">0.7657</td>
</tr>
<tr class="odd">
<td align="left">lda_tuned</td>
<td align="left">n_iter=100,fold=10</td>
<td align="left">0.9992</td>
<td align="left">0.9677</td>
<td align="left">0.7255</td>
<td align="left">0.8340</td>
<td align="left">0.7661</td>
<td align="left">0.7657</td>
</tr>
</tbody>
</table>
<p></br></p>
<h1 style="background-color:tomato;">
Big Data Modelling: PySpark
</h1>
<div class="figure">
<img src="reports/screenshots/pyspark_clf_results.png" />

</div>
<p></br></p>
<h1 style="background-color:tomato;">
Deep Learning Models
</h1>
<table style="width:62%;">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Description</th>
<th align="left">Accuracy</th>
<th align="left">Precision</th>
<th align="left">Recall</th>
<th align="left">F1</th>
<th align="left">AUC</th>
<th align="left">Missed Frauds</th>
<th align="left">Untrue Frauds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">keras</td>
<td align="left">3 layers, 2 dropouts, class_weight</td>
<td align="left">0.983744</td>
<td align="left">0.081818</td>
<td align="left">0.826531</td>
<td align="left">0.148897</td>
<td align="left">0.905273</td>
<td align="left">17</td>
<td align="left">909</td>
</tr>
<tr class="even">
<td align="left">keras</td>
<td align="left">1 layer, dropout, early_stopping</td>
<td align="left">0.984990</td>
<td align="left">0.090811</td>
<td align="left">0.857143</td>
<td align="left">0.164223</td>
<td align="left">0.921177</td>
<td align="left">14</td>
<td align="left">841</td>
</tr>
<tr class="odd">
<td align="left">keras</td>
<td align="left">1 layer, dropout, steps_per_epoch, oversampling</td>
<td align="left">0.982796</td>
<td align="left">0.080000</td>
<td align="left">0.857143</td>
<td align="left">0.146341</td>
<td align="left">0.920077</td>
<td align="left">14</td>
<td align="left">966</td>
</tr>
<tr class="even">
<td align="left">keras</td>
<td align="left">1 layer, class_weight, early_stopping, scikit api</td>
<td align="left">0.987939</td>
<td align="left">0.111989</td>
<td align="left">0.867347</td>
<td align="left">0.198366</td>
<td align="left">0.927747</td>
<td align="left">13</td>
<td align="left">674</td>
</tr>
</tbody>
</table>
<h1 id="references">References</h1>
<ul>
<li>https://www.tensorflow.org/tutorials/structured_data/imbalanced_data</li>
<li>https://keras.io/examples/structured_data/imbalanced_classification/</li>
<li>https://www.kaggle.com/residentmario/using-keras-models-with-scikit-learn-pipelines#</li>
<li>https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/</li>
</ul>
</body>
</html>
